<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#f093fb">
    <title>ğŸ• Poo-Poo Dog Tracker ğŸ’©</title>

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600;700&family=Bubblegum+Sans&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <h1 class="app-title">ğŸ• Poo-Poo Dog Tracker ğŸ’©</h1>
            <div class="poop-counter">
                Cacche trovate: <span id="poopCount">0</span> ğŸ’©
            </div>
        </header>

        <!-- Map Container -->
        <div id="map"></div>

        <!-- Controls -->
        <div class="controls">
            <button id="addPoopBtn" class="btn-add-poop" title="Aggiungi cacca qui!">
                <span class="btn-icon">ğŸ’©</span>
                <span class="btn-text">Cacca Qui!</span>
            </button>

            <button id="centerMapBtn" class="btn-center" title="Centra sulla tua posizione">
                <span class="btn-icon">ğŸ“</span>
            </button>

            <button id="filterBtn" class="btn-filter" title="Filtri e Statistiche">
                <span class="btn-icon">ğŸ“Š</span>
            </button>

            <button id="clearAllBtn" class="btn-clear" title="Cancella tutte le cacche">
                <span class="btn-icon">ğŸ—‘ï¸</span>
            </button>
        </div>

        <!-- Dog Photo Modal -->
        <div id="dogPhotoModal" class="modal">
            <div class="modal-content">
                <h2>ğŸ“¸ Aggiungi la foto del tuo cane!</h2>
                <div class="dog-photo-container">
                    <div id="dogPhotoPreview" class="dog-photo-preview">
                        <span class="placeholder-text">Clicca per aggiungere foto ğŸ•</span>
                    </div>
                    <input type="file" id="dogPhotoInput" accept="image/*" style="display: none;">
                </div>
                <button id="saveDogPhoto" class="btn-save">Salva Foto</button>
                <button id="removeDogPhoto" class="btn-remove">Rimuovi Foto</button>
            </div>
        </div>

        <!-- Poop Details Modal -->
        <div id="poopDetailsModal" class="modal">
            <div class="modal-content modal-details">
                <h2>ğŸ’© Dettagli della Cacca</h2>
                <form id="poopDetailsForm">
                    <div class="form-group">
                        <label>ğŸ˜Š Stato Generale</label>
                        <select id="poopType" required>
                            <option value="healthy">âœ… Sana (Normale)</option>
                            <option value="soft">âš ï¸ Morbida</option>
                            <option value="diarrhea">ğŸ’§ Diarrea</option>
                            <option value="hard">ğŸª¨ Dura/Stitica</option>
                            <option value="blood">ğŸ©¸ Presenza di Sangue</option>
                            <option value="mucus">ğŸ«§ Presenza di Muco</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>ğŸ“ Dimensione</label>
                        <select id="poopSize">
                            <option value="small">Piccola</option>
                            <option value="medium" selected>Media</option>
                            <option value="large">Grande</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>ğŸ¨ Colore</label>
                        <select id="poopColor">
                            <option value="normal" selected>Marrone Normale</option>
                            <option value="light">Chiaro</option>
                            <option value="dark">Scuro</option>
                            <option value="green">Verdastro</option>
                            <option value="yellow">Giallastro</option>
                            <option value="red">Rossastro</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>ğŸ‘ƒ Odore</label>
                        <select id="poopSmell">
                            <option value="normal" selected>Normale</option>
                            <option value="strong">Molto Forte</option>
                            <option value="unusual">Insolito</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>ğŸ“ Note (opzionale)</label>
                        <textarea id="poopNotes" placeholder="Es: Il cane sembrava a disagio, ultimo pasto 3 ore fa..."></textarea>
                    </div>

                    <div class="form-buttons">
                        <button type="submit" class="btn-save">ğŸ’¾ Salva Cacca</button>
                        <button type="button" id="cancelPoopDetails" class="btn-remove">âœ–ï¸ Annulla</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Filters & Stats Modal -->
        <div id="filtersModal" class="modal">
            <div class="modal-content modal-filters">
                <h2>ğŸ“Š Filtri e Statistiche</h2>

                <div class="stats-summary">
                    <div class="stat-card">
                        <div class="stat-number" id="totalPoops">0</div>
                        <div class="stat-label">Totale Cacche</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="healthyPoops">0</div>
                        <div class="stat-label">Sane âœ…</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="problemPoops">0</div>
                        <div class="stat-label">Problemi âš ï¸</div>
                    </div>
                </div>

                <div class="filters-section">
                    <h3>ğŸ” Filtra per:</h3>

                    <div class="form-group">
                        <label>ğŸ“… Periodo</label>
                        <select id="filterPeriod">
                            <option value="all">Tutte</option>
                            <option value="today">Oggi</option>
                            <option value="yesterday">Ieri</option>
                            <option value="week">Ultima Settimana</option>
                            <option value="month">Ultimo Mese</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>ğŸ©º Stato</label>
                        <select id="filterType">
                            <option value="all">Tutti</option>
                            <option value="healthy">Solo Sane âœ…</option>
                            <option value="soft">Solo Morbide âš ï¸</option>
                            <option value="diarrhea">Solo Diarrea ğŸ’§</option>
                            <option value="blood">Con Sangue ğŸ©¸</option>
                            <option value="mucus">Con Muco ğŸ«§</option>
                        </select>
                    </div>

                    <div class="form-buttons">
                        <button id="applyFilters" class="btn-save">âœ”ï¸ Applica Filtri</button>
                        <button id="resetFilters" class="btn-remove">ğŸ”„ Reset</button>
                        <button id="closeFilters" class="btn-secondary">âœ–ï¸ Chiudi</button>
                    </div>
                </div>

                <div class="recent-poops">
                    <h3>ğŸ“‹ Ultime Cacche</h3>
                    <div id="recentPoopsList"></div>
                </div>
            </div>
        </div>

        <!-- Info Toast -->
        <div id="infoToast" class="info-toast">
            <span id="toastMessage"></span>
        </div>
    </div>

    <!-- SVG Icons (hidden) -->
    <svg style="display: none;">
        <defs>
            <!-- Happy Poop -->
            <symbol id="poop-happy" viewBox="0 0 100 100">
                <ellipse cx="50" cy="70" rx="35" ry="30" fill="#8B4513"/>
                <ellipse cx="50" cy="50" rx="30" ry="25" fill="#8B4513"/>
                <ellipse cx="50" cy="30" rx="20" ry="18" fill="#8B4513"/>
                <!-- Eyes -->
                <circle cx="40" cy="45" r="4" fill="white"/>
                <circle cx="60" cy="45" r="4" fill="white"/>
                <circle cx="41" cy="44" r="2" fill="black"/>
                <circle cx="61" cy="44" r="2" fill="black"/>
                <!-- Smile -->
                <path d="M 38 55 Q 50 62 62 55" stroke="white" stroke-width="2" fill="none" stroke-linecap="round"/>
            </symbol>

            <!-- Sad Poop -->
            <symbol id="poop-sad" viewBox="0 0 100 100">
                <ellipse cx="50" cy="70" rx="35" ry="30" fill="#654321"/>
                <ellipse cx="50" cy="50" rx="30" ry="25" fill="#654321"/>
                <ellipse cx="50" cy="30" rx="20" ry="18" fill="#654321"/>
                <!-- Eyes -->
                <circle cx="40" cy="45" r="4" fill="white"/>
                <circle cx="60" cy="45" r="4" fill="white"/>
                <circle cx="41" cy="44" r="2" fill="black"/>
                <circle cx="61" cy="44" r="2" fill="black"/>
                <!-- Sad mouth -->
                <path d="M 38 60 Q 50 53 62 60" stroke="white" stroke-width="2" fill="none" stroke-linecap="round"/>
            </symbol>

            <!-- Sick Poop -->
            <symbol id="poop-sick" viewBox="0 0 100 100">
                <ellipse cx="50" cy="70" rx="35" ry="30" fill="#9b7653"/>
                <ellipse cx="50" cy="50" rx="30" ry="25" fill="#9b7653"/>
                <ellipse cx="50" cy="30" rx="20" ry="18" fill="#9b7653"/>
                <!-- Eyes X_X -->
                <line x1="37" y1="42" x2="43" y2="48" stroke="black" stroke-width="2"/>
                <line x1="43" y1="42" x2="37" y2="48" stroke="black" stroke-width="2"/>
                <line x1="57" y1="42" x2="63" y2="48" stroke="black" stroke-width="2"/>
                <line x1="63" y1="42" x2="57" y2="48" stroke="black" stroke-width="2"/>
                <!-- Wavy mouth -->
                <path d="M 38 57 Q 44 54 50 57 Q 56 60 62 57" stroke="black" stroke-width="2" fill="none"/>
            </symbol>
        </defs>
    </svg>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <!-- App JS -->
    <script src="app.js"></script>
</body>
</html>
